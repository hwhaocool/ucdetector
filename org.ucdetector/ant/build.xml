<?xml version="1.0" encoding="UTF-8"?>
<!-- ====================================================================
  Copyright (c) 2009 Joerg Spieler All rights reserved. This program and the
  accompanying materials are made available under the terms of the Eclipse
  Public License v1.0 which accompanies this distribution, and is available at
  http://www.eclipse.org/legal/epl-v10.html
  ========================================================================= -->
<project name="Run UCDetector" default="detect" basedir=".">
  <description>Run UCDetector in headless mode</description>

  <property name="build.properties" location="build.properties" />

  <!-- ===================================================================== -->
  <!-- DETECT                                                                -->
  <!-- ===================================================================== -->
  <target name="detect" description="Run UCDetector using java">
    <property file="build.properties" />
    <echo>
--------------------------------------------------------------------------------
LAUNCHER  = ${LAUNCHER}
WORKSPACE = ${WORKSPACE}
projects  = ${ucd.projects}
buildtype = ${ucd.buildtype}
ucdoption = ${ucd.options}
--------------------------------------------------------------------------------
</echo>
    <!-- Use next lines, to show more properties
    <property environment="env"/>
    <echoproperties /> 
    -->
    <available file="${build.properties}" property="build.properties.present" />
    <antcall target="create-build.properties" />

    <java jar="${LAUNCHER}" fork="true">
      <arg line="-application org.ucdetector.ucd" />
      <arg line="-consolelog" />
      <arg line="${ucd.debug}" />
      <arg line="-data ${WORKSPACE}" />
      <arg line="-projects ${ucd.projects}" />
      <arg line="-buildtype ${ucd.buildtype}" />
      <arg line="-ucdoptions ${ucd.options}" />
    </java>
  </target>

  <!-- ===================================================================== -->
  <!-- CREATE-BUILD.PROPERTIES                                               -->
  <!-- ===================================================================== -->
  <target name="create-build.properties" unless="build.properties.present">
    <copy file="build.properties_template" tofile="${build.properties}" />
    <echo>Created ${build.properties}</echo>
    <fail>Please edit new file ${build.properties}</fail>
  </target>
</project>

<!-- ==================================================================== -->
<!-- DETECT 2                                                             -->
<!-- ==================================================================== 
  <target name="detect-exe"
          description="Run UCDetector using eclipse executable">
    <property name="EXCECUTABLE" location="/opt/eclipse-3.4/eclipse" />
    <echo>EXCECUTABLE = ${EXCECUTABLE}</echo>
    <echo>WORKSPACE   = ${WORKSPACE}</echo>

    <exec executable="${EXCECUTABLE}">
      <arg value="-application" />
      <arg value="org.ucdetector.ucd" />
      <arg value="-consolelog" />
      <arg value="-debug" />
      <arg value="-nosplash" />
      <arg value="-data" />
      <arg value="-${WORKSPACE}" />
    </exec>
  </target>
  -->
